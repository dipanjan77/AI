# Telemetry Configuration

## Using Bot Configuration (Option 1 of 2)
There are two methods of configuring your bot.  The first assumes you are integrating with Application Insights.

The bot configuration file contains metadata about external services the Bot uses while running.  For example, CosmosDB, Application Insights and the Language Understanding (LUIS) service connection and metadata is stored here.   

If you want "stock" Application Insights, with no additional Application Insights-specific configuration required (for example Telemetry Initializers), pass in the bot configuration object during initialization.   This is the easiest method to initialize and will configure Application Insights to begin tracking Requests, external calls to other services, and correlating events across services.

>ASP.Net Core - Startup.cs
```csharp
public void ConfigureServices(IServiceCollection services)
{
     ...
     // Add Application Insights - pass in the bot configuration
     services.AddBotApplicationInsights(botConfig);
     ...
public void Configure(IApplicationBuilder app, IHostingEnvironment env)
{
     app.UseBotApplicationInsights()
                 ...
                .UseDefaultFiles()
                .UseStaticFiles()
                .UseBotFramework();
```
>Node.js
```js
const appInsightsClient = new ApplicationInsightsTelemetryClient(botConfig);
```

**No Application Insights in Bot Configuration**
What if your bot configuration doesn't contain Application Insights?  No problem, it defaults to a null client which no-ops the method calls.

**Multiple Application Insights**
Have multiple Application Insight sections in your bot configuration?  You can designate which instance of the Application Insights service you want to use inside your bot configuration.

>ASP.Net Core
```csharp
public void ConfigureServices(IServiceCollection services)
{
     // Add Application Insights
     services.AddBotApplicationInsights(botConfig, "myAppInsights");
```
>Node.js
```js
const appInsightsClient = new ApplicationInsightsTelemetryClient(botConfig);
```



## Overriding the Telemetry Client (Option 2 of 2)

If you want to customize your Application Insights client, or you want to log into a completely separate service, you have to configure the system differently.

**Modify Application Insights Configuration**
> ASP.Net Core
```
csharp
public void ConfigureServices(IServiceCollection services)
{
     ...
     // Create Application Insight Telemetry Client
     // with custom configuration.
     var telemetryClient = TelemetryClient(myCustomConfiguration)
     
     // Add Application Insights
     services.AddBotApplicationInsights(new BotTelemetryClient(telemetryClient), "InstrumentationKey");
```
>Node.js
```js
const appInsightsClient = new ApplicationInsightsTelemetryClient(botConfig);
```

**Use Custom Telemetry**
If you want to log telemetry events generated by the Bot Framework into a completely separate system, create a new class derived from the base interface and configure.  



> ASP.Net Core
```
csharp
public void ConfigureServices(IServiceCollection services)
{
     ...
     // Create my IBotTelemetryClient-based logger
     var myTelemetryClient = MyTelemetryLogger();
     
     // Add Application Insights
     services.AddBotApplicationInsights(myTelemetryClient);
```
>Node.js
```js
const appInsightsClient = new ApplicationInsightsTelemetryClient(botConfig);
```